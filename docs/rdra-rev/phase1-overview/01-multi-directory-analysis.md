# 複数ディレクトリ構造分析

## 分析対象システム
- **システム名**: 図書館管理システム
- **ディレクトリ**: ./system-sekkei/library
- **技術スタック**: Java 17 + Spring Boot 3.1.1 + MyBatis + DDD Architecture

## ディレクトリ構造分析

### 1. 全体アーキテクチャ
```
system-sekkei/library/
├── ドメイン駆動設計（DDD）による多層アーキテクチャ
├── RDRA 2.0 ハンドブックのサンプル実装
└── CCSR手法による要件定義・実装統合
```

### 2. 技術レイヤー分析

#### 2.1 ドメイン層 (Domain Layer)
- **場所**: `src/main/java/library/domain/`
- **役割**: ビジネスルール・ロジックの実装
- **技術スタック**: Pure Java (フレームワーク非依存)
- **コンポーネント**:
  - **model/**: ドメインモデル（エンティティ、値オブジェクト）
  - **type/**: 基本型定義（日付、期間など）

#### 2.2 アプリケーション層 (Application Layer)
- **場所**: `src/main/java/library/application/`
- **役割**: ユースケース・業務フローの実装
- **技術スタック**: Spring Framework
- **コンポーネント**:
  - **scenario/**: ビジネスユースケース実装
  - **service/**: アプリケーションサービス
  - **activity/**: アクティビティ定義

#### 2.3 インフラストラクチャ層 (Infrastructure Layer)
- **場所**: `src/main/java/library/infrastructure/`
- **役割**: 外部システム連携・データ永続化
- **技術スタック**: MyBatis + H2/PostgreSQL
- **コンポーネント**:
  - **datasource/**: データベースアクセス
  - **transfer/**: 外部通信

#### 2.4 プレゼンテーション層 (Presentation Layer)
- **場所**: `src/main/java/library/presentation/`
- **役割**: UI・API提供
- **技術スタック**: Spring MVC + Thymeleaf
- **コンポーネント**:
  - **api/**: REST API
  - **xxx/**: 各業務のコントローラー

#### 2.5 リソース層 (Resources)
- **場所**: `src/main/resources/`
- **役割**: 設定・静的コンテンツ
- **技術スタック**: YAML + SQL + HTML/CSS
- **コンポーネント**:
  - **templates/**: Thymeleaf テンプレート
  - **static/**: 静的リソース
  - **schema.sql, data.sql**: データベース初期化

### 3. 業務ドメイン分析

#### 3.1 核心業務ドメイン
1. **貸出・返却 (Loan/Returns)**
   - 実装度: ◎ (完全実装)
   - 複雑度: 高 (貸出制限ルール)
   
2. **予約・取置 (Reservation/Retention)**
   - 実装度: ◎ (完全実装)
   - 複雑度: 高 (状態遷移)

3. **蔵書管理 (Material Management)**
   - 実装度: △ (部分実装)
   - 複雑度: 中

4. **会員管理 (Member Management)**
   - 実装度: △ (部分実装)
   - 複雑度: 低

### 4. 技術的依存関係

#### 4.1 レイヤー間依存関係
```
Presentation → Application → Domain ← Infrastructure
```

#### 4.2 外部依存関係
- **Spring Boot**: アプリケーションフレームワーク
- **MyBatis**: O/Rマッピング
- **H2 Database**: 開発・テスト環境
- **PostgreSQL**: 本番環境想定
- **Thymeleaf**: テンプレートエンジン
- **JIG**: 設計ドキュメント自動生成

### 5. 統合システム観点

#### 5.1 システム境界
- **内部**: 図書館業務システム
- **外部**: 司書（人的リソース）、図書館利用者

#### 5.2 主要インテグレーション
- **データベース**: MyBatis経由でのデータ永続化
- **Web UI**: Thymeleaf + Spring MVC
- **設計ドキュメント**: JIG自動生成
- **テスト**: JUnit + Spring Boot Test

### 6. 開発・運用特性

#### 6.1 開発手法
- **CCSR (Continuous Concurrent Stepwise Refinement)**
- **ドメイン駆動設計 (DDD)**
- **RDRA 2.0 要件定義手法**

#### 6.2 品質保証
- **JIG**: 設計可視化・ドキュメント自動生成
- **SonarCloud**: 静的解析
- **Jacoco**: テストカバレッジ
- **JUnit**: 自動テスト

### 7. 実装スコープ

#### 7.1 実装済み機能
- 貸出・返却業務
- 予約・取置業務
- 貸出制限ルール
- 予約状態遷移
- 基本的な会員管理

#### 7.2 未実装機能
- 蔵書管理（資料発注・登録）
- 会員登録業務
- レファレンスサービス
- イベント管理

## 分析結果サマリー

### システム分類
- **システム種別**: 業務システム（図書館管理）
- **アーキテクチャ**: ドメイン駆動設計による多層構造
- **技術的複雑度**: 中～高
- **業務的複雑度**: 高（複雑な業務ルール）

### 主要特徴
1. **RDRA 2.0 + DDD + CCSR**: 要件定義から実装まで一貫した手法
2. **ビジネスルール中心**: 複雑な貸出制限・予約ルールの実装
3. **設計可視化**: JIGによる自動ドキュメント生成
4. **高い保守性**: 清潔なアーキテクチャと十分なテスト

### 次フェーズへの引き継ぎ事項
- **主要アクター**: 図書館司書、図書館利用者
- **核心業務**: 貸出・返却、予約・取置
- **重要なビジネスルール**: 貸出制限、予約状態遷移
- **外部システム**: 現状はスタンドアロン（将来拡張可能）