# バリエーションシート

## 図書館管理システムのバリエーション定義

### バリエーションシート

| コンテキスト | バリエーション | 値 | 説明 |
|--------|---------|---------------------------|----|
| 会員管理 | 会員種別 | 中学生以上、小学生以下 | 年齢による会員分類。貸出制限の基準となる重要な区分 |
| 会員管理 | 会員状態 | 未登録、有効、無効 | 会員の利用可否を判定する状態区分 |
| 蔵書管理 | 資料種別 | 図書、視聴覚資料 | 貸出対象資料の分類。制限適用の基準 |
| 蔵書管理 | 所蔵品状態 | 未登録、在庫中、予約中、取置中、貸出中、その他 | 個別資料の現在の利用状況を表す状態 |
| 貸出管理 | 延滞状態 | 遅延日数１５日未満、遅延日数２ヶ月未満、遅延日数２ヶ月以上 | 延滞の重篤度レベル。制限適用の基準 |
| 貸出管理 | 貸出可否状態 | 貸出可能、冊数制限により貸出不可、視聴覚資料貸出不可、新規貸出不可、貸出一定期間停止 | 貸出判定の結果状態 |
| 貸出管理 | 返却期限状態 | 期限内、期限切れ | 貸出物の期限状況 |
| 予約管理 | 予約状態 | 未準備、消込済 | 予約の進行状況を管理する状態 |
| 予約管理 | 予約可否状態 | 予約可能、冊数制限により予約不可、視聴覚資料予約不可、予約一定期間停止 | 予約判定の結果状態 |
| 取置管理 | 所蔵品貸出可否 | 貸出可能、貸出中により貸出不可能、予約中により貸出不可能、その他の理由で貸出不可能 | 個別所蔵品の貸出判定結果 |

### バリエーション詳細分析

#### 会員管理コンテキスト

##### 会員種別
- **値の定義**:
  - **中学生以上**: 13歳以上の会員（一般・学生・大人含む）
  - **小学生以下**: 0歳～12歳の会員（幼児・児童）

- **業務的意味**:
  - 貸出可能冊数の決定基準
  - 中学生以上: 20点まで
  - 小学生以下: 15点まで
  - 視聴覚資料: 両方とも5点まで

- **システム実装**: `MemberType` 列挙型
- **変更頻度**: 極めて低（基本的に変更なし）
- **影響範囲**: 貸出制限判定、予約制限判定

##### 会員状態
- **値の定義**:
  - **未登録**: システムに登録されていない状態
  - **有効**: 正常にサービス利用可能な状態
  - **無効**: 資格停止により利用制限されている状態

- **業務的意味**:
  - サービス利用可否の判定基準
  - 有効会員のみ貸出・予約サービス利用可能
  - 無効会員は資格回復まで利用不可

- **システム実装**: `MemberStatus` 列挙型
- **変更頻度**: 中（制裁措置・回復により変動）
- **影響範囲**: 全サービス利用可否

#### 蔵書管理コンテキスト

##### 資料種別
- **値の定義**:
  - **図書**: 書籍、雑誌、新聞等の印刷物
  - **視聴覚資料**: DVD、CD、ビデオ等のメディア

- **業務的意味**:
  - 特別制限の適用基準
  - 視聴覚資料は5点までの特別制限
  - 図書は年齢別の一般制限のみ

- **システム実装**: `EntryType` 列挙型
- **変更頻度**: 極めて低（新しい資料形態の追加時のみ）
- **影響範囲**: 貸出制限判定、予約制限判定

##### 所蔵品状態
- **値の定義**:
  - **未登録**: システム未登録状態
  - **在庫中**: 図書館内にあり利用可能
  - **予約中**: 予約により確保されている状態
  - **取置中**: 予約者のために準備済み状態
  - **貸出中**: 利用者に貸出済み状態
  - **その他**: 廃棄・紛失等の特殊状態

- **業務的意味**:
  - 資料の利用可否判定
  - 在庫中のみ新規貸出可能
  - 状態により利用者への案内内容変更

- **システム実装**: `ItemStatus` 列挙型
- **変更頻度**: 高（業務処理により頻繁に変更）
- **影響範囲**: 貸出可否判定、資料検索結果

#### 貸出管理コンテキスト

##### 延滞状態
- **値の定義**:
  - **遅延日数１５日未満**: 軽微な延滞（猶予期間）
  - **遅延日数２ヶ月未満**: 中程度延滞（新規貸出停止）
  - **遅延日数２ヶ月以上**: 重度延滞（サービス利用停止）

- **業務的意味**:
  - 制限措置の適用レベル決定
  - 段階的な制限措置の実施
  - 督促・指導の強度決定

- **システム実装**: `DelayStatus` 列挙型
- **変更頻度**: 高（日次計算により変動）
- **影響範囲**: 貸出制限、督促処理

##### 貸出可否状態
- **値の定義**:
  - **貸出可能**: 制限なしで貸出実行可能
  - **冊数制限により貸出不可**: 年齢別上限超過
  - **視聴覚資料貸出不可**: 視聴覚資料上限超過
  - **新規貸出不可**: 延滞による制限（中程度）
  - **貸出一定期間停止**: 延滞による停止（重度）

- **業務的意味**:
  - 貸出判定の最終結果
  - 利用者への説明内容決定
  - 司書の対応方針決定

- **システム実装**: `Loanability` 列挙型
- **変更頻度**: 高（貸出要求ごとに判定）
- **影響範囲**: 貸出処理、利用者案内

#### 予約管理コンテキスト

##### 予約状態
- **値の定義**:
  - **未準備**: 予約受付済み、取置準備待ち
  - **消込済**: 予約処理完了（取置・キャンセル・即時貸出）

- **業務的意味**:
  - 予約処理の進行状況管理
  - 司書の作業対象特定
  - 利用者への状況通知

- **システム実装**: `ReservationStatus` 列挙型
- **変更頻度**: 中（予約処理により変動）
- **影響範囲**: 取置業務、予約管理

### バリエーション利用パターン

#### 制限判定での利用

| 判定種別 | 利用バリエーション | 判定ロジック | 結果への影響 |
|----------|-------------------|-------------|-------------|
| 貸出制限判定 | 会員種別、延滞状態、資料種別 | 複合条件評価 | 貸出可否決定 |
| 予約制限判定 | 会員種別、資料種別 | 制限値比較 | 予約可否決定 |
| 状態遷移判定 | 所蔵品状態、予約状態 | 状態マシン | 遷移可否決定 |
| 期限判定 | 返却期限状態、延滞状態 | 日付比較 | 制限レベル決定 |

#### UI表示での利用

| 画面種別 | 利用バリエーション | 表示内容 | 利用者への影響 |
|----------|-------------------|----------|---------------|
| 貸出画面 | 貸出可否状態 | エラーメッセージ | 理由の明確化 |
| 検索画面 | 所蔵品状態 | 利用可否表示 | 利用計画立案 |
| 予約画面 | 予約可否状態 | 制限説明 | 代替案検討 |
| 管理画面 | 延滞状態 | 督促レベル | 対応方針決定 |

### バリエーション品質管理

#### データ品質指標

| バリエーション | 完全性 | 正確性 | 一貫性 | 適時性 | 重要度 |
|---------------|--------|--------|--------|--------|--------|
| 会員種別 | 100% | 100% | 100% | 登録時 | 最高 |
| 会員状態 | 100% | 99% | 99% | リアルタイム | 最高 |
| 資料種別 | 100% | 100% | 100% | 登録時 | 高 |
| 所蔵品状態 | 100% | 99% | 98% | リアルタイム | 最高 |
| 延滞状態 | 100% | 95% | 95% | 日次 | 高 |

#### バリエーション整合性ルール

| ルール名 | 対象バリエーション | 制約内容 | 違反時処理 |
|----------|-------------------|----------|------------|
| 会員状態整合性 | 会員状態、貸出可否状態 | 無効会員は貸出不可 | 自動制限適用 |
| 資料状態整合性 | 所蔵品状態、所蔵品貸出可否 | 状態と可否の一致 | 状態同期 |
| 延滞レベル整合性 | 延滞状態、貸出可否状態 | 延滞レベルと制限一致 | 制限再計算 |
| 予約状態整合性 | 予約状態、所蔵品状態 | 処理状況の一致 | 状態修正 |

### バリエーション進化計画

#### 短期的拡張（6ヶ月以内）

| バリエーション | 拡張内容 | 追加値 | 目的 |
|---------------|----------|--------|------|
| 会員種別 | 特別会員追加 | VIP、教職員 | サービス差別化 |
| 延滞状態 | 段階細分化 | 7日未満、1ヶ月未満 | きめ細かな制御 |
| 所蔵品状態 | メンテナンス状態 | 修理中、整備中 | 資料管理向上 |

#### 中期的拡張（1年以内）

| バリエーション | 拡張内容 | 追加値 | 目的 |
|---------------|----------|--------|------|
| 資料種別 | デジタル資料 | 電子書籍、データベース | デジタル化対応 |
| 貸出可否状態 | 条件付き可能 | 保証人要、短期間のみ | 柔軟な運用 |
| 予約状態 | 処理中状態 | 準備中、確認中 | 進捗可視化 |

#### 長期的拡張（2年以内）

| バリエーション | 拡張内容 | 追加値 | 目的 |
|---------------|----------|--------|------|
| 会員種別 | 外部利用者 | 他館会員、一時利用 | サービス拡張 |
| 所蔵品状態 | 他館貸出 | 他館貸出中、移管中 | 館間連携 |
| 制限状態 | 動的制限 | AI判定、リスクベース | 高度な制御 |

### バリエーション運用指針

#### 変更管理プロセス

1. **影響分析**: 変更による業務・システムへの影響評価
2. **承認プロセス**: 管理者による変更承認
3. **テスト実行**: 変更内容の動作確認
4. **段階的展開**: 限定的な運用開始後の全面展開
5. **効果測定**: 変更後の効果・問題点の評価

#### 教育・周知方法

| 対象者 | 周知方法 | 内容 | タイミング |
|--------|----------|------|------------|
| 司書 | 研修・マニュアル | 新バリエーションの運用方法 | 導入前 |
| 利用者 | 掲示・案内 | サービス変更の通知 | 導入時 |
| 管理者 | 報告書 | 変更による業務影響 | 導入後 |

このバリエーション分析により、図書館管理システムの多様な業務状況と判定ロジックが体系化され、柔軟で正確な業務処理の基盤が構築された。